# https://github.com/coophalco
import json, base64, os, sys, zlib, lzma, gzip, marshal
from Crypto.Protocol.KDF import PBKDF2
from Crypto.Hash import SHA256
from Crypto.Cipher import AES
import getpass

payload = json.loads('{"mode": "password", "salt": "WwJ/sIGBic/yJhjf0oFpAA==", "kdf_iters": 200000, "nonce": "m2dh42Tpa4C53XlH", "tag": "LiEwLWAA0ypwtQyfTdYEgQ==", "ciphertext": "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", "wrapped_key": "gfPbB84Ob8EDndOHHSMOto2eJFYWq8SQg2Z0b3TYSkA=", "wrap_nonce": "8rGFdUwQa62Xu4vq", "wrap_tag": "uZVdxQfka0jGO7uRCCvb8A=="}')
if payload.get("mode") != "password":
    print("Bad payload")
    sys.exit(1)

salt = base64.b64decode(payload["salt"])
iters = int(payload["kdf_iters"])
nonce = base64.b64decode(payload["nonce"])
tag = base64.b64decode(payload["tag"])
ciphertext = base64.b64decode(payload["ciphertext"])

wrapped_key = base64.b64decode(payload["wrapped_key"])
wrap_nonce = base64.b64decode(payload["wrap_nonce"])
wrap_tag = base64.b64decode(payload["wrap_tag"])

pw = os.environ.get("ENCPW")
if pw is None:
    pw = getpass.getpass("press_enter") 
if isinstance(pw, str):
    pw = pw.encode()

kek = PBKDF2(pw, salt, dkLen=32, count=iters, hmac_hash_module=SHA256)

wrap_cipher = AES.new(kek, AES.MODE_GCM, nonce=wrap_nonce)
key = wrap_cipher.decrypt_and_verify(wrapped_key, wrap_tag)

cipher = AES.new(key, AES.MODE_GCM, nonce=nonce)
decompressed = cipher.decrypt_and_verify(ciphertext, tag)

lzmaed = zlib.decompress(decompressed)
gzipped = lzma.decompress(lzmaed)
marshaled = gzip.decompress(gzipped)
codeobj = marshal.loads(marshaled)

exec(codeobj, globals())
